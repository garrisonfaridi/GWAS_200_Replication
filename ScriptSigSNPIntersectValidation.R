#Replication Outputs
gsl.7mSh.blup.assocGF <- read.table("output_200/200_gluc1_maf0.03_miss0.1GF.assoc.txt", header = T) #1
gsl.8MTO.blup.assocGF <- read.table("output_200/200_gluc2_maf0.03_miss0.1GF.assoc.txt", header = T) #2
gsl.3mSOp.blup.assocGF<- read.table("output_200/200_gluc3_maf0.03_miss0.1GF.assoc.txt", header = T) #3
gsl.4mSOb.blup.assocGF <- read.table("output_200/200_gluc4_maf0.03_miss0.1GF.assoc.txt", header = T) #4
gsl.5mSOp.blup.assocGF <- read.table("output_200/200_gluc5_maf0.03_miss0.1GF.assoc.txt", header = T) #5
gsl.6mSOh.blup.assocGF <- read.table("output_200/200_gluc6_maf0.03_miss0.1GF.assoc.txt", header = T) #6
gsl.7mSh.blup.assocGF  <- read.table("output_200/200_gluc7_maf0.03_miss0.1GF.assoc.txt", header = T) #7
gsl.8mSOo.blup.assocGF <- read.table("output_200/200_gluc8_maf0.03_miss0.1GF.assoc.txt", header = T) #8
gsl.Pren.blup.assocGF <- read.table("output_200/200_gluc9_maf0.03_miss0.1GF.assoc.txt", header = T) #9
gsl.Buen.blup.assocGF <- read.table("output_200/200_gluc10_maf0.03_miss0.1GF.assoc.txt", header = T) #10
gsl.Peen.blup.assocGF  <- read.table("output_200/200_gluc11_maf0.03_miss0.1GF.assoc.txt", header = T) #11
gsl.S2hBuen.blup.assocGF <- read.table("output_200/200_gluc12_maf0.03_miss0.1GF.assoc.txt", header = T) #12
gsl.2hPeen.blup.assocGF  <- read.table("output_200/200_gluc13_maf0.03_miss0.1GF.assoc.txt", header = T) #13
gsl.IM.blup.assocG<- read.table("output_200/200_gluc14_maf0.03_miss0.1GF.assoc.txt", header = T) #14
gsl.1moIM.blup.assocGF  <- read.table("output_200/200_gluc15_maf0.03_miss0.1GF.assoc.txt", header = T) #15
gsl.1hIM.blup.assocGF <- read.table("output_200/200_gluc16_maf0.03_miss0.1GF.assoc.txt", header = T) #16
gsl.4moIM.blup.assocGF <<- read.table("output_200/200_gluc17_maf0.03_miss0.1GF.assoc.txt", header = T) #17

#2022 Outputs
gsl.7mSh.blup.assoc.2022 <- read.table("tou_miss10/blup_aliphatic_assoc/lmm_maf03_BlupG7MTH.assoc.fixed.txt", header = T)
gsl.8MTO.blup.assoc.2022 <- read.table("tou_miss10/blup_aliphatic_assoc/lmm_maf03_BlupG8MTO.assoc.fixed.txt", header = T)
gsl.3mSOp.blup.assoc.2022 <- read.table("tou_miss10/blup_aliphatic_assoc/lmm_maf03_BlupG3MSP.assoc.fixed.txt", header = T)
gsl.4mSOb.blup.assoc.2022 <- read.table("tou_miss10/blup_aliphatic_assoc/lmm_maf03_BlupG4MSB.assoc.fixed.txt", header = T)
gsl.5mSOp.blup.assoc.2022 <- read.table("tou_miss10/blup_aliphatic_assoc/lmm_maf03_BlupG5MSP.assoc.fixed.txt", header = T)
gsl.6mSOh.blup.assoc.2022 <- read.table("tou_miss10/blup_aliphatic_assoc/lmm_maf03_BlupG6MSH.assoc.fixed.txt", header = T)
gsl.7mSh.blup.assoc.2022 <- read.table("tou_miss10/blup_aliphatic_assoc/lmm_maf03_BlupG7MSH.assoc.fixed.txt", header = T)
gsl.8mSOo.blup.assoc.2022 <- read.table("tou_miss10/blup_aliphatic_assoc/lmm_maf03_BlupG8MSO.assoc.fixed.txt", header = T)
gsl.Pren.blup.assoc.2022 <- read.table("tou_miss10/blup_aliphatic_assoc/lmm_maf03_BlupG2P.assoc.fixed.txt", header = T)
gsl.Buen.blup.assoc.2022 <- read.table("tou_miss10/blup_aliphatic_assoc/lmm_maf03_BlupG3B.assoc.fixed.txt", header = T)
gsl.Peen.blup.assoc.2022 <- read.table("tou_miss10/blup_aliphatic_assoc/lmm_maf03_BlupG4P.assoc.fixed.txt", header = T)
gsl.S2hBuen.blup.assoc.2022 <- read.table("tou_miss10/blup_aliphatic_assoc/lmm_maf03_BlupG2H3B.assoc.fixed.txt", header = T)
gsl.2hPeen.blup.assoc.2022 <- read.table("tou_miss10/blup_aliphatic_assoc/lmm_maf03_BlupG2H4P.assoc.fixed.txt", header = T)
gsl.IM.blup.assoc.2022 <- read.table("tou_miss10/blup_indolic_assoc/lmm_maf03_BlupGIM.assoc.fixed.txt", header = T)
gsl.1moIM.blup.assoc.2022 <- read.table("tou_miss10/blup_indolic_assoc/lmm_maf03_BlupG1MOIM.assoc.fixed.txt", header = T)
gsl.1hIM.blup.assoc.2022 <- read.table("tou_miss10/blup_indolic_assoc/lmm_maf03_BlupG4HIM.assoc.fixed.txt", header = T) #? nomenclature
gsl.4moIM.blup.assoc.2022 <- read.table("tou_miss10/blup_indolic_assoc/lmm_maf03_BlupG4MOIM.assoc.fixed.txt", header = T)

# Replication Output List
replication_outputs <- list(
  gsl.7mSh.blup.assocGF,
  gsl.8MTO.blup.assocGF,
  gsl.3mSOp.blup.assocGF,
  gsl.4mSOb.blup.assocGF,
  gsl.5mSOp.blup.assocGF,
  gsl.6mSOh.blup.assocGF,
  gsl.7mSh.blup.assocGF,
  gsl.8mSOo.blup.assocGF,
  gsl.Pren.blup.assocGF,
  gsl.Buen.blup.assocGF,
  gsl.Peen.blup.assocGF,
  gsl.S2hBuen.blup.assocGF,
  gsl.2hPeen.blup.assocGF,
  gsl.IM.blup.assocG,
  gsl.1moIM.blup.assocGF,
  gsl.1hIM.blup.assocGF,
  gsl.4moIM.blup.assocGF
)

# 2022 Output List
outputs_2022 <- list(
  gsl.7mSh.blup.assoc.2022,
  gsl.8MTO.blup.assoc.2022,
  gsl.3mSOp.blup.assoc.2022,
  gsl.4mSOb.blup.assoc.2022,
  gsl.5mSOp.blup.assoc.2022,
  gsl.6mSOh.blup.assoc.2022,
  gsl.7mSh.blup.assoc.2022,
  gsl.8mSOo.blup.assoc.2022,
  gsl.Pren.blup.assoc.2022,
  gsl.Buen.blup.assoc.2022,
  gsl.Peen.blup.assoc.2022,
  gsl.S2hBuen.blup.assoc.2022,
  gsl.2hPeen.blup.assoc.2022,
  gsl.IM.blup.assoc.2022,
  gsl.1moIM.blup.assoc.2022,
  gsl.1hIM.blup.assoc.2022,
  gsl.4moIM.blup.assoc.2022
)

# Initialize Results
results <- data.frame(
  Total_Replication_SNPs = integer(),
  Total_2022_SNPs = integer(),
  Intersecting_SNPs = integer()
)

# Loop through paired files
for (i in seq_along(replication_outputs)) {
  # Read the files
  rep_data <- replication_outputs[[i]]
  gloss_data <- outputs_2022[[i]]
  
  # Filter for significant SNPs
  rep_sig <- rep_data[rep_data$p_wald < 0.05,]
  gloss_sig <- gloss_data[gloss_data$p_wald < 0.05,]
  
  # Find intersections
  intersecting_snps <- intersect(rep_sig$rs, gloss_sig$rs)
  
  # Update results
  results[i, "Total_Replication_SNPs"] <- nrow(rep_sig)
  results[i, "Total_2022_SNPs"] <- nrow(gloss_sig)
  results[i, "Intersecting_SNPs"] <- length(intersecting_snps)
  
}

print(results)

write.csv(results, file = "GWAS_Replication_Intercept_Results", row.names = FALSE)

library(writexl)
write_xlsx(results, "GWAS_Replication_Intercept_Results.xlsx")